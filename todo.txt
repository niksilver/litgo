To do
-----

Sections
- Keep track of a contents list (section and its name)
- Add a directive for including the contents list
- Link from each section reference to the section
- Warning when a section jumps a level (e.g. 1 to 3, or nothing to 2)

Chunks
- Write out the chunk name before each chunk.
- Make chunk starts linkable.
- Have a --out-code-dir as an output base directory for code.

Refactoring
- Make fileReader a field of state.

Book and chapters
- Reading books and chapters:
  - If reading chapters, preserve the section number between successive
    files... but make sure the filename changes.
  - Only amend chapter links in the book file, not other files.
  - When amending chapter links don't amend the path, just the suffix,
    even if the book file is not in the base directory.
- Amending for books and chapters:
  - In the book, amend chapter links to be .html files.
  - Ensure amended chapter links retain their relative prefix.
  - Don't amend links to markdown files if initial input file isn't a book.
- Allow section links between chapters.

Directives
- Add a dummy "ignore" directive just to make sure line numbers
  don't get corrupted.

I/O

Done
----

Book and chapters
- Reading books and chapters:
  - If reading chapters, makes sure to read a sequence of files.
  - Follow chapter links only if the file is a book.
  - Follow chapter links only in the top level (book) file.
  - Have a command line flag to say if the markdown file is book with chapters
  - When following chapter links, read the input file relative
    to the book directory.
- Writing books and chapters:
    - Output one documentation file for each input file read.
    - Allow a --doc-out-dir option to write markdown files to directory.

Sections
- Track current section
- Add section number to markdown headings
- Add text after chunk "Added to in sections X, Y and Z"
- Remove the current section from the list "Added to in..."
- Add text after chunk "Used in sections X, Y and Z"
- For "Used in..." make sure the sections come out in order.
- Enable each section to be linkable

Refactoring
- Put the lattice into the state.
- Rearrange the design doc to present more of a design.
- In chunk struct definitions, change field file to be called inName
  for consistency and clarity.
- proc, the line reader, is now a field of state.

I/O
- Read from a file specified by the command line
- Read from stdin
- Write code to files
- Write markup to input filename, but with an "html" suffix.
- Write markup from stdin to "out.html".

Chunks
- HTML code chunks have the language suffix for code highlighting
- Select line directives on the command line.
- Line directives mustn't be indented without a %i
